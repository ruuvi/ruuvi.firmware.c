<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ruuvi.firmware.c: Application sensor control</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ruuvi.firmware.c
   </div>
   <div id="projectbrief">Ruuvi Firmware for nRF52 sensors</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__app__sensor.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Application sensor control<div class="ingroups"><a class="el" href="group__app.html">App</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Initialize, configure and read sensors.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:app__sensor_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__sensor_8c.html">app_sensor.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:app__sensor_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__sensor_8h.html">app_sensor.h</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga06c6546722dfa63c681655e4576a532b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__app__sensor.html#ga06c6546722dfa63c681655e4576a532b">APP_SENSOR_SELFTEST_RETRIES</a>&#160;&#160;&#160;(5U)</td></tr>
<tr class="memdesc:ga06c6546722dfa63c681655e4576a532b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of times to retry init on self-test fail.  <a href="group__app__sensor.html#ga06c6546722dfa63c681655e4576a532b">More...</a><br /></td></tr>
<tr class="separator:ga06c6546722dfa63c681655e4576a532b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2ff399b408dc39318d7968c6e06f844f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__app__sensor.html#ga2ff399b408dc39318d7968c6e06f844f">APP_SENSOR_HANDLE_UNUSED</a>&#160;&#160;&#160;RD_HANDLE_UNUSED</td></tr>
<tr class="separator:ga2ff399b408dc39318d7968c6e06f844f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga11a16c0ee195b19f5f73ef0d41ba0c3f"><td class="memItemLeft" align="right" valign="top">typedef rd_status_t(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__app__sensor.html#ga11a16c0ee195b19f5f73ef0d41ba0c3f">sensor_op</a>) (const ri_comm_xfer_fp_t reply_fp, const rd_sensor_data_fields_t fields, const uint8_t *const raw_message)</td></tr>
<tr class="memdesc:ga11a16c0ee195b19f5f73ef0d41ba0c3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sensor operation, such as read or configure.  <a href="group__app__sensor.html#ga11a16c0ee195b19f5f73ef0d41ba0c3f">More...</a><br /></td></tr>
<tr class="separator:ga11a16c0ee195b19f5f73ef0d41ba0c3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga06fc87d81c62e9abb8790b6e5713c55b"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="group__app__sensor.html#gga06fc87d81c62e9abb8790b6e5713c55baa63fba570fa766597e039da3a69a991b">SENSOR_COUNT</a>
 }</td></tr>
<tr class="separator:ga06fc87d81c62e9abb8790b6e5713c55b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gab130b521ae992c645e83e8231de77783"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__app__sensor.html#gab130b521ae992c645e83e8231de77783">app_sensor_vdd_measure_isr</a> (const ri_radio_activity_evt_t evt)</td></tr>
<tr class="memdesc:gab130b521ae992c645e83e8231de77783"><td class="mdescLeft">&#160;</td><td class="mdescRight">Synchronize VDD measurement to radio activity.  <a href="group__app__sensor.html#gab130b521ae992c645e83e8231de77783">More...</a><br /></td></tr>
<tr class="separator:gab130b521ae992c645e83e8231de77783"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4ca51982d7d6e78a95417f4b741f4e40"><td class="memItemLeft" align="right" valign="top">rd_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__app__sensor.html#ga4ca51982d7d6e78a95417f4b741f4e40">app_sensor_init</a> (void)</td></tr>
<tr class="memdesc:ga4ca51982d7d6e78a95417f4b741f4e40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize sensors into default mode or to a mode stored to flash.  <a href="group__app__sensor.html#ga4ca51982d7d6e78a95417f4b741f4e40">More...</a><br /></td></tr>
<tr class="separator:ga4ca51982d7d6e78a95417f4b741f4e40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga29ed20edf53d81b3771d5836091ff71e"><td class="memItemLeft" align="right" valign="top">rd_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__app__sensor.html#ga29ed20edf53d81b3771d5836091ff71e">app_sensor_uninit</a> (void)</td></tr>
<tr class="memdesc:ga29ed20edf53d81b3771d5836091ff71e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Uninitialize sensors into low-power mode.  <a href="group__app__sensor.html#ga29ed20edf53d81b3771d5836091ff71e">More...</a><br /></td></tr>
<tr class="separator:ga29ed20edf53d81b3771d5836091ff71e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7077aa82166808259f34de69d76e936f"><td class="memItemLeft" align="right" valign="top">rd_sensor_data_fields_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__app__sensor.html#ga7077aa82166808259f34de69d76e936f">app_sensor_available_data</a> (void)</td></tr>
<tr class="memdesc:ga7077aa82166808259f34de69d76e936f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return available data types.  <a href="group__app__sensor.html#ga7077aa82166808259f34de69d76e936f">More...</a><br /></td></tr>
<tr class="separator:ga7077aa82166808259f34de69d76e936f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaccb62302b11b6416a7c0b6af89106432"><td class="memItemLeft" align="right" valign="top">rd_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__app__sensor.html#gaccb62302b11b6416a7c0b6af89106432">app_sensor_get</a> (rd_sensor_data_t *const data)</td></tr>
<tr class="memdesc:gaccb62302b11b6416a7c0b6af89106432"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return last sampled data.  <a href="group__app__sensor.html#gaccb62302b11b6416a7c0b6af89106432">More...</a><br /></td></tr>
<tr class="separator:gaccb62302b11b6416a7c0b6af89106432"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga34f9bf35d1568f2c8135bc48d9da349b"><td class="memItemLeft" align="right" valign="top">rd_sensor_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__app__sensor.html#ga34f9bf35d1568f2c8135bc48d9da349b">app_sensor_find_provider</a> (const rd_sensor_data_fields_t data)</td></tr>
<tr class="memdesc:ga34f9bf35d1568f2c8135bc48d9da349b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find and return a sensor which can provide requested data.  <a href="group__app__sensor.html#ga34f9bf35d1568f2c8135bc48d9da349b">More...</a><br /></td></tr>
<tr class="separator:ga34f9bf35d1568f2c8135bc48d9da349b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad16d5d2b4dd244de46ca3796fb3d4009"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__app__sensor.html#gad16d5d2b4dd244de46ca3796fb3d4009">app_sensor_event_increment</a> (void)</td></tr>
<tr class="memdesc:gad16d5d2b4dd244de46ca3796fb3d4009"><td class="mdescLeft">&#160;</td><td class="mdescRight">Increment event counter of application. Rolls over at 2^32.  <a href="group__app__sensor.html#gad16d5d2b4dd244de46ca3796fb3d4009">More...</a><br /></td></tr>
<tr class="separator:gad16d5d2b4dd244de46ca3796fb3d4009"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gada029e85b696279c1fa6f0ed942fee19"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__app__sensor.html#gada029e85b696279c1fa6f0ed942fee19">app_sensor_event_count_get</a> (void)</td></tr>
<tr class="memdesc:gada029e85b696279c1fa6f0ed942fee19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get current event count.  <a href="group__app__sensor.html#gada029e85b696279c1fa6f0ed942fee19">More...</a><br /></td></tr>
<tr class="separator:gada029e85b696279c1fa6f0ed942fee19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1486749a89720d4d93ad855025f1e76d"><td class="memItemLeft" align="right" valign="top">rd_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__app__sensor.html#ga1486749a89720d4d93ad855025f1e76d">app_sensor_acc_thr_set</a> (float *threshold_g)</td></tr>
<tr class="memdesc:ga1486749a89720d4d93ad855025f1e76d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set threshold for accelerometer interrupts.  <a href="group__app__sensor.html#ga1486749a89720d4d93ad855025f1e76d">More...</a><br /></td></tr>
<tr class="separator:ga1486749a89720d4d93ad855025f1e76d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4851fad1622b44aae8b0b59c58e3221d"><td class="memItemLeft" align="right" valign="top">rd_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__app__sensor.html#ga4851fad1622b44aae8b0b59c58e3221d">app_sensor_handle</a> (const ri_comm_xfer_fp_t ri_reply_fp, const uint8_t *const raw_message, const uint16_t data_len)</td></tr>
<tr class="memdesc:ga4851fad1622b44aae8b0b59c58e3221d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle data coming in to the application.  <a href="group__app__sensor.html#ga4851fad1622b44aae8b0b59c58e3221d">More...</a><br /></td></tr>
<tr class="separator:ga4851fad1622b44aae8b0b59c58e3221d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2642e4561032bf7dc329d9cc41e904f0"><td class="memItemLeft" align="right" valign="top">rd_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__app__sensor.html#ga2642e4561032bf7dc329d9cc41e904f0">app_sensor_vdd_sample</a> (void)</td></tr>
<tr class="memdesc:ga2642e4561032bf7dc329d9cc41e904f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare VDD and take a sample.  <a href="group__app__sensor.html#ga2642e4561032bf7dc329d9cc41e904f0">More...</a><br /></td></tr>
<tr class="separator:ga2642e4561032bf7dc329d9cc41e904f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga92950c1752da844681f2da9ba788ae9c"><td class="memItemLeft" align="right" valign="top">rd_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__app__sensor.html#ga92950c1752da844681f2da9ba788ae9c">app_sensor_sample_config</a> (const rd_sensor_data_fields_t data, const uint32_t interval_ms)</td></tr>
<tr class="memdesc:ga92950c1752da844681f2da9ba788ae9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configure sampling of sensors.  <a href="group__app__sensor.html#ga92950c1752da844681f2da9ba788ae9c">More...</a><br /></td></tr>
<tr class="separator:ga92950c1752da844681f2da9ba788ae9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Initialize, configure and read sensors. </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga2ff399b408dc39318d7968c6e06f844f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2ff399b408dc39318d7968c6e06f844f">&#9670;&nbsp;</a></span>APP_SENSOR_HANDLE_UNUSED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define APP_SENSOR_HANDLE_UNUSED&#160;&#160;&#160;RD_HANDLE_UNUSED</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="app__sensor_8h_source.html#l00038">38</a> of file <a class="el" href="app__sensor_8h_source.html">app_sensor.h</a>.</p>

</div>
</div>
<a id="ga06c6546722dfa63c681655e4576a532b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga06c6546722dfa63c681655e4576a532b">&#9670;&nbsp;</a></span>APP_SENSOR_SELFTEST_RETRIES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define APP_SENSOR_SELFTEST_RETRIES&#160;&#160;&#160;(5U)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of times to retry init on self-test fail. </p>

<p class="definition">Definition at line <a class="el" href="app__sensor_8h_source.html#l00037">37</a> of file <a class="el" href="app__sensor_8h_source.html">app_sensor.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ga11a16c0ee195b19f5f73ef0d41ba0c3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga11a16c0ee195b19f5f73ef0d41ba0c3f">&#9670;&nbsp;</a></span>sensor_op</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef rd_status_t(* sensor_op) (const ri_comm_xfer_fp_t reply_fp, const rd_sensor_data_fields_t fields, const uint8_t *const raw_message)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sensor operation, such as read or configure. </p>
<p>These are used when outside central commands sensor to e.g. configure a sensor or read log. Operations are targeted on specific data types, such as temperature or acceleration. The operation is execcuted on first provider of given data if applicable.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">reply_fp</td><td>A function to which send operation acknowledgement. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fields</td><td>Affected fields. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">raw_message</td><td>Original message triggering operation. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="app__sensor_8c_source.html#l00081">81</a> of file <a class="el" href="app__sensor_8c_source.html">app_sensor.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga06fc87d81c62e9abb8790b6e5713c55b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga06fc87d81c62e9abb8790b6e5713c55b">&#9670;&nbsp;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga06fc87d81c62e9abb8790b6e5713c55baa63fba570fa766597e039da3a69a991b"></a>SENSOR_COUNT&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="app__sensor_8h_source.html#l00040">40</a> of file <a class="el" href="app__sensor_8h_source.html">app_sensor.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga1486749a89720d4d93ad855025f1e76d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1486749a89720d4d93ad855025f1e76d">&#9670;&nbsp;</a></span>app_sensor_acc_thr_set()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rd_status_t app_sensor_acc_thr_set </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>threshold_g</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set threshold for accelerometer interrupts. </p>
<p>Accelerometers are high-passed so gravity won't affect given threshold. Acceleration event is triggered when the threshold is exceeded on any axis. Acceleration event ceases when acceleration falls below the threshold, and can then be triggered again. Maximum rate for acceleration events is then accelerometer sample rate divided by two.</p>
<p>On acceleration event <a class="el" href="group__app__sensor.html#gad16d5d2b4dd244de46ca3796fb3d4009">app_sensor_event_increment</a> is called.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">threshold_g</td><td>In: Thershold of acceleration, &gt; 0. Interpreted as "at least this much". NULL to disable interrupts. Out: Configured threshold. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RD_SUCCESS</td><td>if threshold was configured. </td></tr>
    <tr><td class="paramname">RD_ERROR_NOT_IMPLEMENTED</td><td>if threshold is lower than 0 (negative). </td></tr>
    <tr><td class="paramname">RD_ERROR_NOT_SUPPORTED</td><td>if no suitable accelerometer is initialized. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="app__sensor_8c_source.html#l00466">466</a> of file <a class="el" href="app__sensor_8c_source.html">app_sensor.c</a>.</p>

</div>
</div>
<a id="ga7077aa82166808259f34de69d76e936f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7077aa82166808259f34de69d76e936f">&#9670;&nbsp;</a></span>app_sensor_available_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rd_sensor_data_fields_t app_sensor_available_data </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return available data types. </p>
<dl class="section note"><dt>Note</dt><dd>This is refreshed from sensor structs RAM which makes this a relatively expensive function call due to looping over all sensor contexts. Cache this if microseconds count in your application.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>Listing of data the application can provide. </dd></dl>

<p class="definition">Definition at line <a class="el" href="app__sensor_8c_source.html#l00410">410</a> of file <a class="el" href="app__sensor_8c_source.html">app_sensor.c</a>.</p>

</div>
</div>
<a id="gada029e85b696279c1fa6f0ed942fee19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gada029e85b696279c1fa6f0ed942fee19">&#9670;&nbsp;</a></span>app_sensor_event_count_get()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t app_sensor_event_count_get </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get current event count. </p>
<dl class="section return"><dt>Returns</dt><dd>Number of events accumulated, rolls over at int32_t. </dd></dl>

<p class="definition">Definition at line <a class="el" href="app__sensor_8c_source.html#l00461">461</a> of file <a class="el" href="app__sensor_8c_source.html">app_sensor.c</a>.</p>

</div>
</div>
<a id="gad16d5d2b4dd244de46ca3796fb3d4009"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad16d5d2b4dd244de46ca3796fb3d4009">&#9670;&nbsp;</a></span>app_sensor_event_increment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void app_sensor_event_increment </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Increment event counter of application. Rolls over at 2^32. </p>

<p class="definition">Definition at line <a class="el" href="app__sensor_8c_source.html#l00456">456</a> of file <a class="el" href="app__sensor_8c_source.html">app_sensor.c</a>.</p>

</div>
</div>
<a id="ga34f9bf35d1568f2c8135bc48d9da349b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga34f9bf35d1568f2c8135bc48d9da349b">&#9670;&nbsp;</a></span>app_sensor_find_provider()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rd_sensor_t * app_sensor_find_provider </td>
          <td>(</td>
          <td class="paramtype">const rd_sensor_data_fields_t&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find and return a sensor which can provide requested data. </p>
<p>Loops through sensors in order of priority, if board has SHTC temperature and humidity sensor and LIS2DH12 acceleration and temperature sensor, searching for the sensor will return the one which is first in m_sensors list.</p>
<p>Works only witjh initialized sensors, will not return a sensor which is supported in firmawre but not initialized due to self-test error etc.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>fields which sensor must provide. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to SENSOR, NULL if suitable sensor is not found. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>If parameter data is empty, first initialized sensor will be returned. </dd></dl>

<p class="definition">Definition at line <a class="el" href="app__sensor_8c_source.html#l00440">440</a> of file <a class="el" href="app__sensor_8c_source.html">app_sensor.c</a>.</p>

</div>
</div>
<a id="gaccb62302b11b6416a7c0b6af89106432"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaccb62302b11b6416a7c0b6af89106432">&#9670;&nbsp;</a></span>app_sensor_get()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rd_status_t app_sensor_get </td>
          <td>(</td>
          <td class="paramtype">rd_sensor_data_t *const&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return last sampled data. </p>
<p>This function checks loops through initialized sensors until all data in data-&gt;fields is valid or all sensors are checked.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RD_SUCCESS</td><td>on success, NOT_FOUND sensors are allowed. </td></tr>
    <tr><td class="paramname">RD_ERROR_SELFTEST</td><td>if sensor is found on the bus and fails selftest. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="app__sensor_8c_source.html#l00425">425</a> of file <a class="el" href="app__sensor_8c_source.html">app_sensor.c</a>.</p>

</div>
</div>
<a id="ga4851fad1622b44aae8b0b59c58e3221d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4851fad1622b44aae8b0b59c58e3221d">&#9670;&nbsp;</a></span>app_sensor_handle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rd_status_t app_sensor_handle </td>
          <td>(</td>
          <td class="paramtype">const ri_comm_xfer_fp_t&#160;</td>
          <td class="paramname"><em>ri_reply_fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *const&#160;</td>
          <td class="paramname"><em>raw_message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint16_t&#160;</td>
          <td class="paramname"><em>data_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle data coming in to the application. </p>
<p>Interprets the desired action, executes it and aknowledges to reply_fp with ri_comm_message_t containing ruuvi endpoint encoded message.</p>
<p>For example a Log Read command gets replied with all the logged elements.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ri_reply_fp</td><td>Function pointer to send replies to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">raw_message</td><td>Payload sent by client. Must be a standard Ruuvi Endpoint message. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data_len</td><td>Payload sent by client.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RD_SUCCESS</td><td>Data was handled, including replying with error to reply_fp. </td></tr>
    <tr><td class="paramname">RD_ERROR_NULL</td><td>Raw message or replyfp is NULL. </td></tr>
    <tr><td class="paramname">RD_ERROR_DATA_SIZE</td><td>data_len is less than RE_STANDARD_MESSAGE_LENGTH.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>Executing these commands can be resource intensive. Consider stopping app_heartbeat before entering this function. </dd></dl>

<p class="definition">Definition at line <a class="el" href="app__sensor_8c_source.html#l00886">886</a> of file <a class="el" href="app__sensor_8c_source.html">app_sensor.c</a>.</p>

</div>
</div>
<a id="ga4ca51982d7d6e78a95417f4b741f4e40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4ca51982d7d6e78a95417f4b741f4e40">&#9670;&nbsp;</a></span>app_sensor_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rd_status_t app_sensor_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize sensors into default mode or to a mode stored to flash. </p>
<p>This function checks <a class="el" href="app__config_8h.html">app_config.h</a> for enabled sensors and initializes each of them into mode stored into flash, or into default mode defined in <a class="el" href="app__config_8h.html">app_config.h</a> if the mode is not stored in flash. Internal sampling rate of sensors does not affect reading rate of sensors, reading rate must be configured separately.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RD_SUCCESS</td><td>on success, NOT_FOUND sensors are allowed. </td></tr>
    <tr><td class="paramname">RD_ERROR_INVALID_STATE</td><td>if GPIO or GPIO interrupts are not enabled. </td></tr>
    <tr><td class="paramname">RD_ERROR_SELFTEST</td><td>if sensor is found on the bus and fails selftest. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="app__sensor_8c_source.html#l00318">318</a> of file <a class="el" href="app__sensor_8c_source.html">app_sensor.c</a>.</p>

</div>
</div>
<a id="ga92950c1752da844681f2da9ba788ae9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga92950c1752da844681f2da9ba788ae9c">&#9670;&nbsp;</a></span>app_sensor_sample_config()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rd_status_t app_sensor_sample_config </td>
          <td>(</td>
          <td class="paramtype">const rd_sensor_data_fields_t&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>interval_ms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configure sampling of sensors. </p>
<p>This function lets application know what data and how often should be read. To use sampled data, call <a class="el" href="group__app__sensor.html#gaccb62302b11b6416a7c0b6af89106432">app_sensor_get</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Data fields to sample. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">interval_ms</td><td>Interval to sample at. At minimum 1000 ms.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RD_SUCCESS</td><td>on success. </td></tr>
    <tr><td class="paramname">RD_ERROR_INVALID_PARAM</td><td>if interval is less than 1000 ms.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>: Future minor version may allow using intervals down to 1 ms on sensors with built-in FIFOs and read the FIFO in batches. </dd></dl>

</div>
</div>
<a id="ga29ed20edf53d81b3771d5836091ff71e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga29ed20edf53d81b3771d5836091ff71e">&#9670;&nbsp;</a></span>app_sensor_uninit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rd_status_t app_sensor_uninit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Uninitialize sensors into low-power mode. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RD_SUCCESS</td><td>On success. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code from stack on error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="app__sensor_8c_source.html#l00384">384</a> of file <a class="el" href="app__sensor_8c_source.html">app_sensor.c</a>.</p>

</div>
</div>
<a id="gab130b521ae992c645e83e8231de77783"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab130b521ae992c645e83e8231de77783">&#9670;&nbsp;</a></span>app_sensor_vdd_measure_isr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void app_sensor_vdd_measure_isr </td>
          <td>(</td>
          <td class="paramtype">const ri_radio_activity_evt_t&#160;</td>
          <td class="paramname"><em>evt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Synchronize VDD measurement to radio activity. </p>
<p>Call this function before and after radio events to notify the device that ADC should be prepared to sample the droop voltage and to take the sample after heavy loading.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">evt</td><td>Type of next radio event, RI_RADIO_BEFORE ot RI_RADIO_AFTER </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="app__sensor_8c_source.html#l00157">157</a> of file <a class="el" href="app__sensor_8c_source.html">app_sensor.c</a>.</p>

</div>
</div>
<a id="ga2642e4561032bf7dc329d9cc41e904f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2642e4561032bf7dc329d9cc41e904f0">&#9670;&nbsp;</a></span>app_sensor_vdd_sample()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rd_status_t app_sensor_vdd_sample </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepare VDD and take a sample. </p>
<p>Call this function during initialization process to take a VDD sample for the first heartbeat message.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RD_SUCCESS</td><td>on success </td></tr>
    <tr><td class="paramname">RD_ERROR_INVALID_STATE</td><td>if ADC is not prepared </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="app__sensor_8c_source.html#l00926">926</a> of file <a class="el" href="app__sensor_8c_source.html">app_sensor.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
